<?xml version="1.0" encoding="UTF-8"?>

<project name="Jazzee" default="build" basedir='.'>
 <property name="source" value="."/>
 <property name="build" value="build"/>

 <target name="clean"
         description="Clean up and create build directories">
  <delete dir="${build}/jazzee"/>
  <mkdir dir="${build}/jazzee"/>
  <subant target="clean">
      <fileset dir="lib/foundation" includes="build.xml" />
    </subant>
  </target>

  <target name="src" description="Prepares a clean source tree">
	  <copy todir="${build}/jazzee">
	    <fileset dir="${source}" includes="src/ webroot/ setup/ var/"/>
	  </copy>
	  <copy todir="${build}/jazzee/etc">
      <fileset dir="${source}/etc/" excludes="config.ini.php"/>
    </copy>
    <copy todir="${build}/jazzee/lib">
      <fileset dir="${source}/lib/" excludes="foundation/"/>
    </copy>
    <subant target="export">
      <fileset dir="lib/foundation" includes="build.xml" />
    </subant>
    <copy todir="${build}/jazzee/lib/foundation">
      <fileset dir="${source}/lib/foundation/build/foundation/"/>
    </copy>
 </target>

 <target name="export" depends="clean,src"/>
 <target name="archive" depends="export">
   <tar destfile="${basedir}/build/jazzee.tar" basedir="${basedir}/build/jazzee" />
 </target>
</project>